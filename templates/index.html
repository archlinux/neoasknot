<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="color-scheme" content="dark">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="${description}">
    <meta name="author" content="${author}">
    % if googlesiteverification:
    <meta name="google-site-verification" content="${googlesiteverification}">
    % endif
    % if favicon:
    <link rel="shortcut icon" href="${favicon}">
    % endif

    <title>${title}</title>

    <link rel="stylesheet" href="../site.css">
    <script>
        var SEP = '${SEP}';
        var all_ids = ${all_ids_as_json};
        var question_tree = ${tree_as_json};
    </script>
  </head>

  <body class="flex flex-col h-screen justify-center gap-y-32 text-center bg-base-200 bg-body-background bg-cover">

    <div class="navbar w-auto mb-2 text-neutral-content mx-20">
      <div class="flex-1 px-2 mx-2">
        <span class="bg-navbar-logo w-40 h-14 bg-cover indent-[-9999px]">${title}</span>
      </div>
      <nav class="flex-none">
        <ul class="flex">
          % for info in navlinks:
          <li
          % if info['link'] == 'javascript:reloadHome();':
          class="active"
          % endif
          ><a href="${info['link']}" class="px-2 mx-2">${info['name']}</a></li>
          % endfor
        </ul>
      </nav>
    </div>

    <main>

<%def name="card(node, next, segue1=None, segue2=None, toplevel=False)">
      <div id="${node['id']}" class="hidden">

        % if segue1:
        <p class="segue1">${segue1}</p>
        % endif

        % if segue2:
        <p class="segue2">${segue2}</p>
        % endif

        <div class="bandana bg-base-100">
          <span class="main-text">
            % if 'title' in node:
            <h1 class="title">${node['title']}</h1>
            % endif

            % if 'subtitle' in node:
            <p class="subtitle"><span>${node['subtitle']}</span></p>
            % endif
          </span>
          % if 'image' in node:
          <div class="img"><img src="${node['image']}"></div>
          % endif
        </div>
        % if 'children' in node:
        <p>
          <a data-next="${node['children'][0]['id']}" class="yes btn btn-success m-2">‚úîÔ∏è ${node['affirmative']}</a>
        </p>
        % else:
        <p>
          <a href="${node['link']}" class="btn btn-success m-2">‚úîÔ∏è ${node['affirmative']}</a>
        </p>
        % endif:

        % if next != node['id']:
        <p>
          <a data-next="${next}" class="nope btn btn-error m-2">‚ùå ${node['negative']}</a>
        </p>
        % endif
        % if not toplevel:
        <p>
          <a class="back btn btn-warning m-2">üîô ${node['backlink']}</a>
        </p>
        % endif
      </div>

      % if 'children' in node:
        % for i, child in enumerate(node['children']):
${card(child, node['children'][(i + 1) % len(node['children'])]['id'], segue1=node.get('segue1'), segue2=node.get('segue2'))}
        % endfor
      % endif
</%def>

      % for i, child in enumerate(tree['children']):
${card(child, tree['children'][(i + 1) % len(tree['children'])]['id'], segue1=tree.get('segue1'), segue2=tree.get('segue2'), toplevel=True)}
      % endfor

    </main>

    <footer class="p-4 footer text-base-content footer-center">
      <div>
        <span>Generated by <a href="https://gitlab.archlinux.org/archlinux/asknot-ng">asknot-ng</a>,
        originally written by <a href="http://threebean.org">Ralph Bean</a> and <a
          href="https://github.com/fedora-infra/asknot-ng/graphs/contributors">others</a>.
        Inspired by <a href="https://whatcanidoformozilla.org">the original</a>.
        <div class="dropdown dropdown-top dropdown-end">
          <div tabindex="0" class="btn-link">üåê Change Language</div>
          <ul tabindex="0" class="shadow menu max-h-screen overflow-y-scroll dropdown-content bg-base-100 rounded-box">
            % for l in languages:
            <li><a href="../${l}/">${l}</a></li>
            % endfor
          </ul>
        </div></span>
      </div>
    </footer>

    <!-- This is where the magic happens -->
    <script src="../static/site.js"></script>
  </body>
</html>
